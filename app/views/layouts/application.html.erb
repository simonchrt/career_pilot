<!DOCTYPE html>
<html>
  <head>
    <title>CareerPilot</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_include_tag "application", "data-turbo-track": "reload", defer: true %>
  </head>

  <body class="bg-gray-100 min-h-screen">
    <% if user_signed_in? %>
      <div class="flex h-screen">
        <!-- Sidebar -->
        <div class="bg-gray-800 text-white w-64 py-4 flex-shrink-0">
          <div class="px-4 mb-6">
            <h1 class="text-xl font-bold">CareerPilot</h1>
          </div>
          <nav>
            <ul>
              <li>
                <%= link_to dashboard_path, class: "flex items-center px-4 py-2 hover:bg-gray-700 #{current_page?(dashboard_path) ? 'bg-gray-700' : ''}", data: { turbo: false } do %>
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
                  </svg>
                  Tableau de bord
                <% end %>
              </li>
              <li>
                <%= link_to applications_path, class: "flex items-center px-4 py-2 hover:bg-gray-700 #{controller_name == 'applications' ? 'bg-gray-700' : ''}", data: { turbo: false } do %>
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" />
                    <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd" />
                  </svg>
                  Mes candidatures
                <% end %>
              </li>
              <li>
                <%= link_to job_listings_path, class: "flex items-center px-4 py-2 hover:bg-gray-700 #{controller_name == 'job_listings' ? 'bg-gray-700' : ''}" do %>
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M6 6V5a3 3 0 013-3h2a3 3 0 013 3v1h2a2 2 0 012 2v3.57A22.952 22.952 0 0110 13a22.95 22.95 0 01-8-1.43V8a2 2 0 012-2h2zm2-1a1 1 0 011-1h2a1 1 0 011 1v1H8V5zm1 5a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z" clip-rule="evenodd" />
                    <path d="M2 13.692V16a2 2 0 002 2h12a2 2 0 002-2v-2.308A24.974 24.974 0 0110 15c-2.796 0-5.487-.46-8-1.308z" />
                  </svg>
                  Offres d'emploi
                <% end %>
              </li>
              <li>
                <%= link_to companies_path, class: "flex items-center px-4 py-2 hover:bg-gray-700 #{controller_name == 'companies' ? 'bg-gray-700' : ''}" do %>
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 110 2h-3a1 1 0 01-1-1v-2a1 1 0 00-1-1H9a1 1 0 00-1 1v2a1 1 0 01-1 1H4a1 1 0 110-2V4zm3 1h2v2H7V5zm2 4H7v2h2V9zm2-4h2v2h-2V5zm2 4h-2v2h2V9z" clip-rule="evenodd" />
                  </svg>
                  Entreprises
                <% end %>
              </li>
              <li>
                <%= link_to technologies_path, class: "flex items-center px-4 py-2 hover:bg-gray-700 #{controller_name == 'technologies' ? 'bg-gray-700' : ''}" do %>
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                  </svg>
                  Technologies
                <% end %>
              </li>
              <li>
                <%= link_to new_quick_application_path, class: "flex items-center px-4 py-2 hover:bg-gray-700 #{controller_name == 'quick_applications' ? 'bg-gray-700' : ''}", data: { turbo: false } do %>
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd" />
                  </svg>
                  Candidature rapide
                <% end %>
              </li>
            </ul>
          </nav>
          <div class="mt-auto px-4 py-2 border-t border-gray-700">
            <div class="flex items-center mb-2">
              <div class="rounded-full bg-gray-600 w-8 h-8 flex items-center justify-center mr-2">
                <%= current_user.full_name.first.upcase rescue "U" %>
              </div>
              <div>
                <p class="text-sm font-semibold"><%= current_user.full_name %></p>
              </div>
            </div>
            <div class="text-sm">
              <%= link_to "Mon profil", edit_user_registration_path, class: "text-gray-300 hover:text-white" %>
              <span class="mx-1">|</span>
              <%= button_to "DÃ©connexion", destroy_user_session_path, method: :delete, class: "text-gray-300 hover:text-white bg-transparent border-0 p-0" %>
            </div>
          </div>
        </div>

        <!-- Main content -->
        <div class="flex-1 overflow-auto">
          <!-- Header -->
          <header class="bg-white shadow">
            <div class="max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex justify-between items-center">
              <h1 class="text-xl font-bold text-gray-900">
                <%= content_for(:page_title) || controller_name.capitalize %>
              </h1>
              <div>
                <%= content_for(:page_actions) %>
              </div>
            </div>
          </header>

          <!-- Flash messages -->
          <% if notice %>
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-4">
              <div class="bg-green-50 border-l-4 border-green-400 p-4 text-green-700">
                <p><%= notice %></p>
              </div>
            </div>
          <% end %>

          <% if alert %>
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-4">
              <div class="bg-red-50 border-l-4 border-red-400 p-4 text-red-700">
                <p><%= alert %></p>
              </div>
            </div>
          <% end %>

          <!-- Main content -->
          <main class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
            <%= yield %>
          </main>
        </div>
      </div>
    <% else %>
      <!-- Header for non-logged in users -->
      <header class="bg-white shadow">
        <div class="max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex justify-between items-center">
          <h1 class="text-xl font-bold text-gray-900">CareerPilot</h1>
          <div>
            <%= link_to "Connexion", new_user_session_path, class: "text-blue-600 hover:text-blue-800 mr-4" %>
            <%= link_to "Inscription", new_user_registration_path, class: "px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700" %>
          </div>
        </div>
      </header>

      <!-- Flash messages -->
      <% if notice %>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-4">
          <div class="bg-green-50 border-l-4 border-green-400 p-4 text-green-700">
            <p><%= notice %></p>
          </div>
        </div>
      <% end %>

      <% if alert %>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-4">
          <div class="bg-red-50 border-l-4 border-red-400 p-4 text-red-700">
            <p><%= alert %></p>
          </div>
        </div>
      <% end %>

      <!-- Main content -->
      <main class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
        <%= yield %>
      </main>
    <% end %>
  </body>
</html>
